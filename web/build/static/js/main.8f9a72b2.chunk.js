(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{27:function(e,n,t){e.exports=t(39)},39:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),i=t(22),c=t.n(i),o=t(17),u=t(3),l=t(9),s=t(1);function d(){var e=Math.floor(Date.now()/1e3).toString(),n=Math.floor(4294967296*Math.random()).toString();return Number.parseInt(n+e).toString(36)}var f=t(2),h="#007AFF",m="rgba(0, 122, 255, 0.85)",b="rgba(0, 122, 255, 0.75)",p="white",v="black",g="#8E8E93",x="white",E="#F2F2F7",w="#FF3B30";function O(){var e=Object(s.a)(["\n    background-color: ",";\n    font-size: ",";\n    font-weight: bold;    \n    color: ",";\n    padding: ",";\n    border-radius: 8px;\n    cursor: pointer;\n    border: 2px transparent solid;\n    transition: .2s background-color, .2s border;\n    \n    &:focus {\n        outline: 0;\n        border: 2px "," solid;\n        background-color: ",";\n    }\n    \n    &:hover {\n        background-color: ",";\n    }\n    \n    &:active {\n        background-color: ",";\n    }\n    \n    &:disabled {\n        background-color: ",";\n    }\n"]);return O=function(){return e},e}var j=f.a.button(O(),h,(function(e){return"big"===e.size?"16px":"14px"}),p,(function(e){return"big"===e.size?"12px 16px":"8px 16px"}),h,m,m,b,g);function y(){var e=Object(s.a)(["\n    width: ","px;\n    height: ","px;\n"]);return y=function(){return e},e}var k=f.a.div(y(),(function(e){return e.size}),(function(e){return e.size})),z=t(10),C=t.n(z),S=t(12),P=t(7);function K(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 16px;\n    margin-left: 8px;\n"]);return K=function(){return e},e}function M(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 16px;\n    line-height: 1.2;\n"]);return M=function(){return e},e}function D(){var e=Object(s.a)(["\n    border-radius: 4px;\n    border: 1px "," solid;\n    padding: 8px 12px;\n    width: ",";\n    box-sizing: border-box;\n    display: flex;\n    background-color: ",";\n    cursor: text; \n    align-items: center;\n    transition: .1s border;\n    \n    &:focus-within {\n        outline: 0;\n        border: 1px "," solid;\n    }\n"]);return D=function(){return e},e}function N(){var e=Object(s.a)(["\n    border: 0px;\n    background-color: transparent;\n    padding: 0px;\n    margin: 0px;\n    font-size: 16px;\n    line-height: 1.2;\n    flex-grow: 1;\n    \n    &:focus {\n        outline: 0;\n    }\n    \n    &::placeholder {\n        color: ",";\n    }\n"]);return N=function(){return e},e}var A=f.a.input(N(),g),J=f.a.div(D(),(function(e){return e.invalid?w:v}),(function(e){return e.width}),x,(function(e){return e.invalid?w:h})),I=f.a.div(M(),g),L=f.a.div(K(),(function(e){return e.invalid?w:v}));function R(e){var n,t,i,c=Object(a.useRef)(null);return r.a.createElement("div",null,r.a.createElement(L,{invalid:null!==(n=e.invalid)&&void 0!==n&&n},e.label),r.a.createElement(k,{size:8}),r.a.createElement(J,{invalid:null!==(t=e.invalid)&&void 0!==t&&t,onClick:function(){var e,n;return null===c||void 0===c||null===(e=c.current)||void 0===e||null===(n=e.focus)||void 0===n?void 0:n.call(e)},width:e.width},r.a.createElement(I,null,e.prefix),r.a.createElement(A,{ref:c,placeholder:e.placeholder,value:e.value,onChange:function(n){if(!n.target.value)return void e.onChange(n.target.value);e.charLimit&&n.target.value.length>e.charLimit&&(n.target.value=n.target.value.slice(0,e.charLimit));if(e.shouldMatchRegex&&!e.shouldMatchRegex.test(n.target.value))return;if(e.customIsAllowed&&!e.customIsAllowed(n.target.value))return;e.onChange(n.target.value)},autoComplete:"new-password",type:null!==(i=e.type)&&void 0!==i?i:"text"})))}var F="http://localhost:4000",T=function(e,n){return fetch("".concat(F,"/api/createChat"),{method:"POST",body:JSON.stringify({key:e,name:n})})},_=function(e,n){return fetch("".concat(F,"/api/joinChat"),{method:"POST",body:JSON.stringify({chatId:e,name:n})}).then((function(e){return e.json()}))},Z=function(e){return fetch("".concat(F,"/api/loadChatMeta?key=").concat(e)).then((function(e){return e.json()}))},V=function(e){return fetch("".concat(F,"/api/isKeyAvailable?key=").concat(e)).then((function(e){return e.json()}))};function B(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 12px;\n    text-align: center;\n    line-height: 1em;\n"]);return B=function(){return e},e}function U(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 16px;\n    font-weight: bold;\n    text-align: center;\n    line-height: 1em;\n"]);return U=function(){return e},e}function W(){var e=Object(s.a)(["\n    border-radius: 8px;\n    background: ",";\n    padding: 24px 20px;\n"]);return W=function(){return e},e}var $=new RegExp("^[a-zA-Z0-9\u0430-\u044f\u0410-\u042f][a-zA-Z0-9\u0430-\u044f\u0410-\u042f-_.]*$"),Y=new RegExp("^[a-zA-Z0-9\u0430-\u044f\u0410-\u042f-_.,()@ ]*$"),q=f.a.div(W(),E),G=f.a.div(U(),v),H=f.a.div(B(),g);function Q(e){var n=Object(a.useState)(!1),t=Object(l.a)(n,2),i=t[0],c=t[1],o=Object(a.useState)(!0),u=Object(l.a)(o,2),s=u[0],d=u[1],f=Object(a.useMemo)((function(){return function(e,n,t){var a=null,r=0;return function(i){a&&clearTimeout(a);var c=++r;a=setTimeout(Object(S.a)(C.a.mark((function e(){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(i);case 2:a=e.sent,c===r&&t(a);case 4:case"end":return e.stop()}}),e)}))),e)}}(300,(function(n){return n?(c(!0),e.onValidityChange(!1),V(n)):Promise.resolve(!0)}),(function(n){c(!1),d(n),e.onValidityChange(n)}))}),[]);return r.a.createElement(q,null,r.a.createElement(G,null,"Optional preferences"),r.a.createElement(k,{size:8}),r.a.createElement(H,null,"You can choose your own values instead of generated"),r.a.createElement(k,{size:32}),r.a.createElement(R,{label:i?"Making sure link is available...":s?"Link":"Link is already taken",value:e.userPreferences.key,onChange:function(e){return h.apply(this,arguments)},invalid:!s,prefix:"webchat.com/",placeholder:e.defaultPreferences.key,charLimit:255,shouldMatchRegex:$,customIsAllowed:function(e){for(var n=0;n<e.length;n++)if(("."===e[n]||"_"===e[n]||"-"===e[n])&&n!==e.length-1&&e[n+1]===e[n])return!1;return!0},width:"320px"}),r.a.createElement(k,{size:24}),r.a.createElement(R,{label:"Chat name",value:e.userPreferences.name,onChange:function(n){return e.onChange(Object(P.a)(Object(P.a)({},e.userPreferences),{},{name:n}))},placeholder:e.defaultPreferences.name,charLimit:80,shouldMatchRegex:Y,width:"320px"}),r.a.createElement(k,{size:24}),r.a.createElement(R,{label:"Password",value:e.userPreferences.password,onChange:function(n){return e.onChange(Object(P.a)(Object(P.a)({},e.userPreferences),{},{password:n}))},charLimit:255,placeholder:e.defaultPreferences.password,type:"password",width:"320px"}));function h(){return(h=Object(S.a)(C.a.mark((function n(t){return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.onChange(Object(P.a)(Object(P.a)({},e.userPreferences),{},{key:t})),d(!0),f(t);case 3:case"end":return n.stop()}}),n)})))).apply(this,arguments)}}function X(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 20px;\n    text-align: center;\n    line-height: 1em;\n"]);return X=function(){return e},e}function ee(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 40px;\n    font-weight: bold;\n    line-height: 1em;\n"]);return ee=function(){return e},e}function ne(){var e=Object(s.a)(["\n    padding: 80px;\n    margin: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n"]);return ne=function(){return e},e}var te=f.a.div(ne()),ae=f.a.div(ee(),v),re=f.a.div(X(),g);function ie(){var e=Object(a.useMemo)((function(){return{key:d(),name:"Reasonable Peacocks",password:""}}),[]),n=Object(a.useState)(""),t=Object(l.a)(n,2),i=t[0],c=t[1],o=Object(a.useState)({key:"",name:"",password:""}),s=Object(l.a)(o,2),f=s[0],h=s[1],m=Object(a.useState)(!0),b=Object(l.a)(m,2),p=b[0],v=b[1];return i?r.a.createElement(u.a,{to:i,push:!0}):r.a.createElement(te,null,r.a.createElement(ae,null,"WebChat"),r.a.createElement(k,{size:64}),r.a.createElement(re,null,"A simple web messenger that allows you create chat rooms and invite your friends."),r.a.createElement(k,{size:12}),r.a.createElement(re,null,"Just press the button and share the link! "),r.a.createElement(k,{size:64}),r.a.createElement(j,{size:"big",disabled:!p,onClick:function(){var n=f.key?f.key:e.key,t=f.name?f.name:e.name;T(n,t).then((function(e){e.ok?c("/"+n):alert("Error occurred")})).catch((function(e){return alert(e)}))}},"Create chat"),r.a.createElement(k,{size:64}),r.a.createElement(Q,{defaultPreferences:e,userPreferences:f,onChange:h,onValidityChange:v}))}function ce(){var e=Object(s.a)(["\n    width: ",";\n    height: ",";\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n"]);return ce=function(){return e},e}var oe=f.a.div(ce(),(function(e){return e.width?e.width:"100%"}),(function(e){return e.height?e.height:"fit-content"}));function ue(){var e=Object(s.a)(["\n    font-size: 12px;\n    color: ",";\n"]);return ue=function(){return e},e}function le(){var e=Object(s.a)(["\n    font-weight: bold;\n    font-size: 16px;\n"]);return le=function(){return e},e}function se(){var e=Object(s.a)(["\n    width: 64px;\n    height: 64px;\n    background: #DFD600;\n    border-radius: 32px;\n"]);return se=function(){return e},e}function de(){var e=Object(s.a)(["\n    background-color: ",";\n    border: 1px solid #E5E5EA;\n    box-sizing: border-box;\n    border-radius: 8px;\n    padding: 24px 20px;\n"]);return de=function(){return e},e}var fe=f.a.div(de(),E),he=f.a.div(se()),me=f.a.div(le()),be=f.a.div(ue(),g);function pe(e){return r.a.createElement(fe,null,r.a.createElement(oe,null,r.a.createElement(he,null),r.a.createElement(k,{size:24}),r.a.createElement(me,null,e.groupName),r.a.createElement(k,{size:4}),r.a.createElement(be,null,"webchat.com/",e.groupKey),r.a.createElement(k,{size:56}),r.a.createElement(R,{label:"Name",value:e.name,onChange:e.onNameChange,width:"320px",placeholder:e.defaultName,charLimit:75}),r.a.createElement(k,{size:48}),r.a.createElement(j,{size:"small",onClick:e.onJoinClick},"Join")))}var ve=t(26),ge=new function e(){var n=this;Object(ve.a)(this,e),this.subscriptions=[],this.get=function(e){var t=window.localStorage.getItem(n.getKey(e));return t?JSON.parse(t):null},this.update=function(e,t){var a=window.localStorage.getItem(n.getKey(e)),r=a?JSON.parse(a):{},i=Object(P.a)(Object(P.a)({},r),t);window.localStorage.setItem(n.getKey(e),JSON.stringify(i)),n.subscriptions.filter((function(n){return n.chatKey===e})).forEach((function(e){return e.callback(i)}))},this.subscribe=function(e){return n.subscriptions.push(e)},this.getKey=function(e){return"chat_".concat(e)}};function xe(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 20px;\n    text-align: center;\n    line-height: 1em;\n"]);return xe=function(){return e},e}function Ee(){var e=Object(s.a)(["\n    color: ",";\n    font-size: 40px;\n    font-weight: bold;\n    line-height: 1em;\n"]);return Ee=function(){return e},e}function we(){var e=Object(s.a)(["\n    padding: 80px;\n    margin: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n"]);return we=function(){return e},e}var Oe=f.a.div(we()),je=f.a.div(Ee(),v),ye=f.a.div(xe(),g);function ke(e){var n,t,i=Object(a.useMemo)((function(){return"Anonymous Cat"}),[]),c=Object(a.useState)(""),o=Object(l.a)(c,2),u=o[0],s=o[1];return Object(a.useEffect)((function(){var n;(null===(n=e.chatData)||void 0===n?void 0:n.meta)||Z(e.chatKey).then((function(n){return ge.update(e.chatKey,{meta:{id:n.id,key:n.key,name:n.name,created:n.created}})}))}),[e.chatData,e.chatKey]),r.a.createElement(Oe,null,r.a.createElement(je,null,"WebChat"),r.a.createElement(k,{size:64}),r.a.createElement(ye,null,"Type your name and choose an avatar to join the chat"),r.a.createElement(k,{size:64}),!(null===(n=e.chatData)||void 0===n?void 0:n.meta)&&"Loading...",(null===(t=e.chatData)||void 0===t?void 0:t.meta)&&r.a.createElement(pe,{name:u,defaultName:i,onNameChange:function(e){return s(e)},groupName:e.chatData.meta.name,groupKey:e.chatData.meta.key,onJoinClick:Object(S.a)(C.a.mark((function n(){var t,a,r,c,o,l;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=u||i,null!==(null===(t=e.chatData)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.id)&&void 0!==(null===(r=e.chatData)||void 0===r||null===(c=r.meta)||void 0===c?void 0:c.id)){n.next=3;break}throw Error("Chat Id was null when clicked 'Join'");case 3:return n.next=5,_(e.chatData.meta.id,o);case 5:l=n.sent,ge.update(e.chatKey,{myUser:Object(P.a)(Object(P.a)({},l.user),{},{token:l.token}),members:l.members});case 7:case"end":return n.stop()}}),n)})))}))}function ze(){var e,n=Object(a.useMemo)((function(){var e=new RegExp("^/([a-zA-Z\u0430-\u044f\u0410-\u042f0-9-_.]+)/?").exec(window.location.pathname);if(e&&e.length>1)return e[1];return""}),[]),t=Object(a.useState)(ge.get(n)),i=Object(l.a)(t,2),c=i[0],o=i[1];return Object(a.useEffect)((function(){ge.subscribe({chatKey:n,callback:o})}),[]),(null===c||void 0===c?void 0:c.meta)&&c.myUser?r.a.createElement("div",null,null===(e=c.members)||void 0===e?void 0:e.map((function(e){return r.a.createElement("div",null,e.name)})),r.a.createElement("input",null)):r.a.createElement(ke,{chatKey:n,chatData:c})}console.log("123");var Ce=function(){return r.a.createElement(o.a,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0},r.a.createElement(ie,null)),r.a.createElement(u.b,{path:"/"},r.a.createElement(ze,null))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ce,null)),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.8f9a72b2.chunk.js.map